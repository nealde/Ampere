# import SPM_fd_sei
# import numpy as np
#
# # a = [1e-14, 1e-14, 51555.0, 30555.0, 3.0617941083699977e-05, 8.8e-05, 1.7759947536470463e-05, 2e-06, 303.15, 1000.0, 885000.0, 723600.0, 0.026, 2100.0, 1.0, 9.547752229435438e-09, 8.307e-12, 1.5e-06, 30.0, 30.0, 0.5, 1.0, 0.0, 7374.749498997995, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 3.67873289259766, 0.18276374809384, 30.0, 0.0, 1e-10, 0.0, 0.0, 0.0, 3.0596914450382, 30.0]
# # a = [1e-14, 1e-14, 51555.0, 30555.0, 9.576666666666656e-05, 8.8e-05, 1.7750000000000004e-06, 2e-06, 303.15, 1000.0, 885000.0, 723600.0, 0.026, 2100.0, 1.0, 2.1394999999999974e-09, 8.307e-12, 1.5e-06, 30.0, 30.0, 0.5, 1.0, 0.0, 7875.751503006012, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 3.67873289259766, 0.18276374809384, 30.0, 0.0, 1e-10, 0.0, 0.0, 0.0, 3.0596914450382, 30.0]
# # a = [1e-14, 1e-14, 51555.0, 30555.0, 8.750000000000003e-05, 8.8e-05, 1.5e-06, 2e-06, 303.15, 1000.0, 885000.0, 723600.0, 0.026, 2100.0, 1.0, 2.334e-09, 8.307e-12, 1.5e-06, 30.0, 30.0, 0.5, 1.0, 0.0, 7875.751503006012, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 3.67873289259766, 0.18276374809384, 30.0, 0.0, 1e-10, 0.0, 0.0, 0.0, 3.0596914450382, 30.0]
# a = [1e-14, 1e-14, 51555.0, 30555.0, 1.760130699125293e-06, 8.8e-05, 0.00015760463696714083, 2e-06, 303.15, 1000.0, 885000.0, 723600.0, 0.026, 2100.0, 1.0, 1.615807618653774e-09, 8.307e-12, 1.5e-06, 30.0, 30.0, -0.5, 1.0, 0.0, 7374.749498997995, 25141.7672, 25141.7672, 25141.7672, 25141.7672, 25141.7672, 25141.7672, 25141.7672, 25141.7672, 25141.7672, 25141.7672, 25141.7672, 25141.7672, 25141.7672, 25141.7672, 25141.7672, 25141.7672, 25141.7672, 25141.7672, 25141.7672, 25141.7672, 25141.7672, 25141.7672, 25141.7672, 25141.7672, 25141.7672, 25141.7672, 25141.7672, 25141.7672, 25141.7672, 25141.7672, 25141.7672, 25141.7672, 27392.1225, 27392.1225, 27392.1225, 27392.1225, 27392.1225, 27392.1225, 27392.1225, 27392.1225, 27392.1225, 27392.1225, 27392.1225, 27392.1225, 27392.1225, 27392.1225, 27392.1225, 27392.1225, 27392.1225, 27392.1225, 27392.1225, 27392.1225, 27392.1225, 27392.1225, 27392.1225, 27392.1225, 27392.1225, 27392.1225, 27392.1225, 27392.1225, 27392.1225, 27392.1225, 27392.1225, 27392.1225, 4.26700382, 0.0670038247, 0.002652952, 0.007347048, 1.6351392e-10, 30.827151, 30.8183958, 0.00875512593, 4.2, -0.5]
# a = np.array(a)
# # for i in range(len(a)):
# # 	print(a[i], i)
# b = np.zeros((10000,int(a[18]+a[19]+15)))
# print(b.shape)
# import time
# st = time.time()
# # for i in range(10):
# for i in range(100):
# 	a[4] += .1e-6
# 	SPM_fd_sei.model(a, b)
# 	count = np.nonzero(b[:,-2])[0][-1]+1
# 	print(count)
# print(a[4])
# # print(count)
# # print(b[count])
# print(b[:,[0,-2]])
#
# print((time.time()-st))
#
# print(a, b)

import SPM_fd
import numpy as np

# a = [1e-14, 1e-14, 51555.0, 30555.0, 3.0617941083699977e-05, 8.8e-05, 1.7759947536470463e-05, 2e-06, 303.15, 1000.0, 885000.0, 723600.0, 0.026, 2100.0, 1.0, 9.547752229435438e-09, 8.307e-12, 1.5e-06, 30.0, 30.0, 0.5, 1.0, 0.0, 7374.749498997995, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 3.67873289259766, 0.18276374809384, 30.0, 0.0, 1e-10, 0.0, 0.0, 0.0, 3.0596914450382, 30.0]
# a = [1e-14, 1e-14, 51555.0, 30555.0, 9.576666666666656e-05, 8.8e-05, 1.7750000000000004e-06, 2e-06, 303.15, 1000.0, 885000.0, 723600.0, 0.026, 2100.0, 1.0, 2.1394999999999974e-09, 8.307e-12, 1.5e-06, 30.0, 30.0, 0.5, 1.0, 0.0, 7875.751503006012, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 3.67873289259766, 0.18276374809384, 30.0, 0.0, 1e-10, 0.0, 0.0, 0.0, 3.0596914450382, 30.0]

# a = [1e-14, 1e-14, 51555.0, 30555.0, 3.0617941083699977e-05, 8.8e-05, 1.7759947536470463e-05, 2e-06, 303.15, 1000.0, 885000.0, 723600.0, 0.026, 2100.0, 1.0, 9.547752229435438e-09, 8.307e-12, 1.5e-06, 30.0, 30.0, 1.0, 1.0, 1.0, 7374.749498997995, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 3.67873289259766, 0.18276374809384, 3.0596914450382, 30.0]

# a = [1e-14, 1e-14, 51555.0, 30555.0, 3.0617941083699977e-05, 8.8e-05, 1.7759947536470463e-05, 2e-06, 303.15, 1000.0, 885000.0, 723600.0, 9.547752229435438e-09, 8.307e-12, 30.0, 30.0, 1.0, 1.0, 1.0, 7374.749498997995, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 3.67873289259766, 0.18276374809384, 3.0596914450382, 30.0]

a = [1e-14, 1e-14, 51555.0, 30555.0, 8e-05, 8.8e-05, 2e-06, 2e-06, 303.15, 1000.0, 885000.0, 723600.0, 2.334e-11, 8.307e-12, 30.0, 30.0, 0.5, 1.0, 0.0, 10000.0, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 49503.111, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 305.55, 3.67873289259766, 0.18276374809384, 3.0596914450382, 30.0]

# neq = a[14]+a[15]+8
#
# # a = [1e-14, 1e-14, 51555.0, 30555.0, 3.0617941083699977e-05, 8.8e-05, 1.7759947536470463e-05, 2e-06, 303.15, 1000.0, 885000.0, 723600.0, 9.547752229435438e-09, 8.307e-12, 30.0, 30.0, 0.5, 1.0, 1.0, 7374.749498997995]
#
# a = np.array(a)
# for i in range(len(a)):
# 	print(a[i], i)
#
# b = np.zeros((10000,int(a[14]+a[15]+9)))
# # # print(b.shape)
# import time
# st = time.time()
# # for i in range(50):
# SPM_fd.model(a, b)
# # print((time.time()-st)/50)
# count = np.nonzero(b[1:,0])[0][-1]+1
# # print(b[:,0])
# print(count)
# # print(b[count-1])
# for i in range(count+1):
# 	print(b[i,[0,-2, -1]])
# print(list(b[count]))

from solve import spm_fd
print(spm_fd(a[:21], initial=1.0))
